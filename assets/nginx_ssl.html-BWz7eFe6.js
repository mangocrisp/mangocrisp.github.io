import{_ as i,c as a,e as n,o as e}from"./app-YJLVW2Ql.js";const l={};function t(h,s){return e(),a("div",null,s[0]||(s[0]=[n(`<h1 id="nginx-配置-ssl" tabindex="-1"><a class="header-anchor" href="#nginx-配置-ssl"><span>Nginx 配置 ssl</span></a></h1><p>如果你的网站是 Nginx 服务，并且需要访问的时候带上 https，那么就需要在 Nginx 配置 ssl</p><h2 id="yum-安装" tabindex="-1"><a class="header-anchor" href="#yum-安装"><span>yum 安装</span></a></h2><h3 id="_1-安装" tabindex="-1"><a class="header-anchor" href="#_1-安装"><span>1. 安装</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-启动" tabindex="-1"><a class="header-anchor" href="#_2-启动"><span>2. 启动</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_3-设置开机自启" tabindex="-1"><a class="header-anchor" href="#_3-设置开机自启"><span>3. 设置开机自启</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_4-停止" tabindex="-1"><a class="header-anchor" href="#_4-停止"><span>4. 停止</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_5-重启" tabindex="-1"><a class="header-anchor" href="#_5-重启"><span>5. 重启</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_6-目录" tabindex="-1"><a class="header-anchor" href="#_6-目录"><span>6. 目录</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/etc/nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    配置文件目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/var/log/nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   日志目录（这个，你可以自己在配置文件里面配置）</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="官网下载安装-推荐" tabindex="-1"><a class="header-anchor" href="#官网下载安装-推荐"><span>官网下载安装（推荐）</span></a></h2><p>去官网下载下来 nginx-x.x.x.tar.gz，上传到服务器</p><h3 id="_1-解压源代码" tabindex="-1"><a class="header-anchor" href="#_1-解压源代码"><span>1. 解压源代码</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx-x.x.x.tar.gz</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="_2-安装编译环境和相关依赖" tabindex="-1"><a class="header-anchor" href="#_2-安装编译环境和相关依赖"><span>2. 安装编译环境和相关依赖</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> gcc-c++</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> openssl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> openssl-devel</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pcre</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> pcre-devel</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">yum</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -y</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zlib</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> zlib-devel</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-自定义配置安装" tabindex="-1"><a class="header-anchor" href="#_3-自定义配置安装"><span>3. 自定义配置安装</span></a></h3><p><a href="http://nginx.org/en/docs/configure.html" target="_blank" rel="noopener noreferrer">自定义配置</a></p><h3 id="_4-安装" tabindex="-1"><a class="header-anchor" href="#_4-安装"><span>4. 安装</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx-x.x.x</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./configure</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --prefix=/usr/local/nginx</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">make</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> install</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">提示</p><p>这里，如果没有 make ,需要先安装 make<br> yum install make</p></div><h3 id="_5-启动" tabindex="-1"><a class="header-anchor" href="#_5-启动"><span>5. 启动</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">cd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /usr/local/nginx/sbin</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">./nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_6-设置自动启动" tabindex="-1"><a class="header-anchor" href="#_6-设置自动启动"><span>6. 设置自动启动</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">vim</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /lib/systemd/system/nginx.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><details class="hint-container details"><summary>nginx.service</summary><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>[Unit]</span></span>
<span class="line"><span>#描述服务</span></span>
<span class="line"><span>Description=nginx</span></span>
<span class="line"><span>#描述服务类别</span></span>
<span class="line"><span>After=network.target</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>#服务运行参数的设置，注意【Service】的启动、重启、停止命令都要用绝对路径</span></span>
<span class="line"><span>[Service]</span></span>
<span class="line"><span>#后台运行的形式</span></span>
<span class="line"><span>Type=forking</span></span>
<span class="line"><span>#服务具体运行的命令</span></span>
<span class="line"><span>ExecStart=/usr/local/nginx/sbin/nginx</span></span>
<span class="line"><span>#重启命令</span></span>
<span class="line"><span>ExecReload=/usr/local/nginx/sbin/nginx -s reload</span></span>
<span class="line"><span>#停止命令</span></span>
<span class="line"><span>ExecStop=/usr/local/nginx/sbin/nginx -s quit</span></span>
<span class="line"><span>#表示给服务分配独立的临时空间</span></span>
<span class="line"><span>PrivateTmp=true</span></span>
<span class="line"><span> </span></span>
<span class="line"><span>#运行级别下服务安装的相关设置，可设置为多用户，即系统运行级别为3</span></span>
<span class="line"><span>[Install]</span></span>
<span class="line"><span>WantedBy=multi-user.target</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><p>开机自动启动：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.service</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>nginx其他命令：</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.service　（启动nginx服务）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.service　（停止nginx服务）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> （设置开机自启动）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> disable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> （停止开机自启动）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> （查看服务当前状态）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> nginx.service　（重新启动服务）</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> list-units</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --type=service</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> （查看所有已启动的服务）</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-目录" tabindex="-1"><a class="header-anchor" href="#_7-目录"><span>7. 目录</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/local/nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   nginx</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 主目录</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/local/nginx/conf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   配置文件夹</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">/usr/local/nginx/logs</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">   日志文件夹</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="生成-ssl-证书" tabindex="-1"><a class="header-anchor" href="#生成-ssl-证书"><span>生成 ssl 证书</span></a></h2><p>Nginx 配置需要证书和密钥，可以去阿里云或者腾讯云等服务商获取证书，一般是申请域名的时候也一并申请证书，这些证书都是互联网可信任的证书，当然，如果你的系统是运行在内网或者一些其他局域网，根本也不需要验证证书的可用性，就是单纯的使用 https，那么，就可以选择自己生成</p><h3 id="windows-准备" tabindex="-1"><a class="header-anchor" href="#windows-准备"><span>Windows 准备</span></a></h3><ol><li>生成证书的方式有很多种，这里默认已经下载了最新的 <a href="https://github.com/git-for-windows/git/releases/download/v2.46.0.windows.1/Git-2.46.0-64-bit.exe" target="_blank" rel="noopener noreferrer">Git</a>，就可以使用 <code>Git Bash</code> 下面的功能 <code>openssl</code></li></ol><h3 id="linux-准备" tabindex="-1"><a class="header-anchor" href="#linux-准备"><span>Linux 准备</span></a></h3><ol><li>需要系统有 openssl</li><li>需要 nginx 有安装 ssl 模块</li></ol><div class="hint-container tip"><p class="hint-container-title">提示</p><p><a href="https://www.cnblogs.com/echohye/p/16722833.html" target="_blank" rel="noopener noreferrer">参考</a></p></div><h3 id="openssl" tabindex="-1"><a class="header-anchor" href="#openssl"><span>openssl</span></a></h3><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">openssl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> req</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -x509</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -nodes</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -days</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 3650</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -newkey</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> rsa:2048</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -keyout</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> server.key</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -out</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> server.crt</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -config</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> req.cnf</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -sha256</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>参数说明：</p><ul><li>req：大致有3个功能：生成证书请求文件、验证证书请求文件和创建根CA</li><li>-x509：说明生成自签名证书</li><li>-nodes：<code>openssl req</code> 在自动创建私钥时，将总是加密该私钥文件，并提示输入加密的密码。可以使用 <code>-nodes</code> 选项禁止加密私钥文件</li><li>-days：指定所颁发的证书有效期</li><li>-newkey：实际上，<code>-x509</code> 选项和 <code>-new</code> 或 <code>-newkey</code> 配合使用时，可以不指定证书请求文件，它在自签署过程中将在内存中自动创建证书请求文件,<code>-newkey</code> 选项和 <code>-new</code> 选项类似，只不过 <code>-newkey</code> 选项可以直接指定私钥的算法和长度，所以它主要用在 <code>openssl req</code> 自动创建私钥时</li><li><code>rsa:2048</code>：<code>rsa</code> 表示创建 <code>rsa</code> 私钥，<code>2048</code> 表示私钥的长度</li><li>-keyout：指定私钥保存位置</li><li>-out：新的证书请求文件位置</li><li>-config：指定 <code>req</code> 的配置文件</li></ul><details class="hint-container details"><summary>req.cnf</summary><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" data-title="bash" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 定义输入用户信息选项的&quot;特征名称&quot;字段名，该扩展字段定义了多项用户信息。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">distinguished_name</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> req_distinguished_name</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 生成自签名证书时要使用的证书扩展项字段名，该扩展字段定义了要加入到证书中的一系列扩展项。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">x509_extensions</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> v3_req</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 如果设为no，那么 req 指令将直接从配置文件中读取证书字段的信息，而不提示用户输入。</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">prompt</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> no</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[req_distinguished_name]</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">#国家代码，一般都是CN(大写)</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">C</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> CN</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">#省份</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">ST</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GuangDong</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">#城市</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">L</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> GuangZhou</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">#企业/单位名称</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">O</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Mango</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">#企业部门</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">OU</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> Crisp</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">#证书的主域名</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">CN</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> mangocrisp.gitlab.io</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;">##### 要加入到证书请求中的一系列扩展项 #####</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[v3_req]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">keyUsage</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> critical,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> digitalSignature,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> keyAgreement</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">extendedKeyUsage</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> serverAuth</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">subjectAltName</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> @alt_names</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[ alt_names ]</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">IP.1</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> =</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> 35.185.44.232</span></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># IP.2 = 35.185.44.232</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h2 id="配置-nginx" tabindex="-1"><a class="header-anchor" href="#配置-nginx"><span>配置 Nginx</span></a></h2><p>执行上面的命令之后会在当前目录生成 server.key 和 server.crt 两个文件，你可以将两个文件放到 nginx 的安装目录/ssl 下</p><h3 id="nginx-conf" tabindex="-1"><a class="header-anchor" href="#nginx-conf"><span>nginx.conf</span></a></h3><details class="hint-container details"><summary>nginx.conf</summary><div class="language-conf line-numbers-mode" data-highlighter="shiki" data-ext="conf" data-title="conf" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>http {</span></span>
<span class="line"><span>    server {</span></span>
<span class="line"><span>        #监听80端口，强制转到443端口，进行https访问</span></span>
<span class="line"><span>        listen  80;</span></span>
<span class="line"><span>        server_name localhost;    </span></span>
<span class="line"><span>        rewrite ^(.*)$  https://$host$1 permanent;</span></span>
<span class="line"><span>    }    </span></span>
<span class="line"><span>    server {</span></span>
<span class="line"><span>        listen  443 ssl;</span></span>
<span class="line"><span>        server_name  localhost;</span></span>
<span class="line"><span>        # ssl 配置</span></span>
<span class="line"><span>        ssl_session_cache shared:SSL:10m;</span></span>
<span class="line"><span>        ssl_session_timeout 120m;</span></span>
<span class="line"><span>        ssl_prefer_server_ciphers on;</span></span>
<span class="line"><span>        ssl_session_tickets off;</span></span>
<span class="line"><span>        ssl_stapling_verify on;</span></span>
<span class="line"><span>        ssl_certificate     D:/dev/bin/nginx-1.20.2/ssl/server.crt; #证书格式有多种，常见的有pem、cer等</span></span>
<span class="line"><span>        ssl_certificate_key D:/dev/bin/nginx-1.20.2/ssl/server.key;</span></span>
<span class="line"><span>        ssl_ciphers ECDHE-RSA-AES128-GCM-SHA256:ECDHE:ECDH:AES:HIGH:!NULL:!aNULL:!MD5:!ADH:!RC4;</span></span>
<span class="line"><span>        ssl_protocols TLSv1 TLSv1.1 TLSv1.2;</span></span>
<span class="line"><span>        # 其他配置</span></span>
<span class="line"><span>        location / {</span></span>
<span class="line"><span>            root   html;</span></span>
<span class="line"><span>            try_files $uri $uri/ /index.html;</span></span>
<span class="line"><span>            index  index.html index.htm;</span></span>
<span class="line"><span>        }</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><div class="hint-container tip"><p class="hint-container-title">提示</p><p>如果有些请求是你一定要配置 http 的，那就得取消强制 https</p></div><h2 id="参考链接" tabindex="-1"><a class="header-anchor" href="#参考链接"><span>参考链接</span></a></h2><p><a href="https://blog.csdn.net/lyfqyr/article/details/124215774" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/lyfqyr/article/details/124215774</a><br><a href="https://www.cnblogs.com/echohye/p/16722833.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/echohye/p/16722833.html</a></p>`,56)]))}const r=i(l,[["render",t],["__file","nginx_ssl.html.vue"]]),d=JSON.parse('{"path":"/ware/soft/nginx_ssl.html","title":"Nginx 配置 ssl","lang":"zh-CN","frontmatter":{"shortTitle":"Nginx 配置 ssl","description":"Nginx 配置 ssl","index":true,"comment":true,"article":true,"timeline":true,"lastUpdated":true,"editLink":true,"contributors":true,"order":3,"dir":{"order":3},"icon":"simple-icons:nginx","isOriginal":false,"date":"2024-09-16T00:00:00.000Z","category":["软/硬件知识"],"tag":["知识","分享","软件知识","Nginx","Https"],"cover":"https://nginx.org/nginx.png","head":[["meta",{"property":"og:url","content":"https://mangocrisp.github.io/ware/soft/nginx_ssl.html"}],["meta",{"property":"og:site_name","content":"Mango Crisp"}],["meta",{"property":"og:title","content":"Nginx 配置 ssl"}],["meta",{"property":"og:description","content":"Nginx 配置 ssl"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:image","content":"https://nginx.org/nginx.png"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2024-09-22T18:05:48.000Z"}],["meta",{"name":"twitter:card","content":"summary_large_image"}],["meta",{"name":"twitter:image:src","content":"https://nginx.org/nginx.png"}],["meta",{"name":"twitter:image:alt","content":"Nginx 配置 ssl"}],["meta",{"property":"article:author","content":"Mango Crisp"}],["meta",{"property":"article:tag","content":"知识"}],["meta",{"property":"article:tag","content":"分享"}],["meta",{"property":"article:tag","content":"软件知识"}],["meta",{"property":"article:tag","content":"Nginx"}],["meta",{"property":"article:tag","content":"Https"}],["meta",{"property":"article:published_time","content":"2024-09-16T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2024-09-22T18:05:48.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Nginx 配置 ssl\\",\\"image\\":[\\"https://nginx.org/nginx.png\\"],\\"datePublished\\":\\"2024-09-16T00:00:00.000Z\\",\\"dateModified\\":\\"2024-09-22T18:05:48.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mango Crisp\\",\\"url\\":\\"https://github.com/mangocrisp\\"}]}"]]},"headers":[{"level":2,"title":"yum 安装","slug":"yum-安装","link":"#yum-安装","children":[{"level":3,"title":"1. 安装","slug":"_1-安装","link":"#_1-安装","children":[]},{"level":3,"title":"2. 启动","slug":"_2-启动","link":"#_2-启动","children":[]},{"level":3,"title":"3. 设置开机自启","slug":"_3-设置开机自启","link":"#_3-设置开机自启","children":[]},{"level":3,"title":"4. 停止","slug":"_4-停止","link":"#_4-停止","children":[]},{"level":3,"title":"5. 重启","slug":"_5-重启","link":"#_5-重启","children":[]},{"level":3,"title":"6. 目录","slug":"_6-目录","link":"#_6-目录","children":[]}]},{"level":2,"title":"官网下载安装（推荐）","slug":"官网下载安装-推荐","link":"#官网下载安装-推荐","children":[{"level":3,"title":"1. 解压源代码","slug":"_1-解压源代码","link":"#_1-解压源代码","children":[]},{"level":3,"title":"2. 安装编译环境和相关依赖","slug":"_2-安装编译环境和相关依赖","link":"#_2-安装编译环境和相关依赖","children":[]},{"level":3,"title":"3. 自定义配置安装","slug":"_3-自定义配置安装","link":"#_3-自定义配置安装","children":[]},{"level":3,"title":"4. 安装","slug":"_4-安装","link":"#_4-安装","children":[]},{"level":3,"title":"5. 启动","slug":"_5-启动","link":"#_5-启动","children":[]},{"level":3,"title":"6. 设置自动启动","slug":"_6-设置自动启动","link":"#_6-设置自动启动","children":[]},{"level":3,"title":"7. 目录","slug":"_7-目录","link":"#_7-目录","children":[]}]},{"level":2,"title":"生成 ssl 证书","slug":"生成-ssl-证书","link":"#生成-ssl-证书","children":[{"level":3,"title":"Windows 准备","slug":"windows-准备","link":"#windows-准备","children":[]},{"level":3,"title":"Linux 准备","slug":"linux-准备","link":"#linux-准备","children":[]},{"level":3,"title":"openssl","slug":"openssl","link":"#openssl","children":[]}]},{"level":2,"title":"配置 Nginx","slug":"配置-nginx","link":"#配置-nginx","children":[{"level":3,"title":"nginx.conf","slug":"nginx-conf","link":"#nginx-conf","children":[]}]},{"level":2,"title":"参考链接","slug":"参考链接","link":"#参考链接","children":[]}],"git":{"createdTime":1726425310000,"updatedTime":1727028348000,"contributors":[{"name":"yinxijie","email":"yinxijie@gzgxinfo.com","commits":2},{"name":"XiJieYin","email":"2415446179@qq.com","commits":1}]},"readingTime":{"minutes":5.13,"words":1540},"filePathRelative":"ware/soft/nginx_ssl.md","localizedDate":"2024年9月16日","excerpt":"\\n<p>如果你的网站是 Nginx 服务，并且需要访问的时候带上 https，那么就需要在 Nginx 配置 ssl</p>\\n<h2>yum 安装</h2>\\n<h3>1. 安装</h3>\\n<div class=\\"language-bash line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"bash\\" data-title=\\"bash\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">yum</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> install</span><span style=\\"--shiki-light:#986801;--shiki-dark:#D19A66\\"> -y</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> nginx</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div></div></div>"}');export{r as comp,d as data};
